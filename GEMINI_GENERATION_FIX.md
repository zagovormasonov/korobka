# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç Gemini API –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞

## üîç –ü—Ä–æ–±–ª–µ–º—ã

–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤–æ–∑–Ω–∏–∫–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **‚ùå `personal_plan_unlocked` –æ—Å—Ç–∞–µ—Ç—Å—è `false`** 
   - –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –ø–æ–ª–µ `personal_plan_unlocked` –≤ –ë–î –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –Ω–∞ `true`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–º—É –ø–ª–∞–Ω—É

2. **‚ùå –ú–∞—Å–∫–æ—Ç –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ**
   - Gemini API –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è, —Ç–∞–∫ –∫–∞–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –æ—Ç–≤–µ—Ç—ã –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ (`answers = null`)
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–ª –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Ç–µ—Å—Ç–∞–º

3. **‚ùå –ù–µ –ø–æ–¥–±–∏—Ä–∞—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**
   - –ò–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª AI-–∞–Ω–∞–ª–∏–∑ –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤

## üîß –†–µ—à–µ–Ω–∏–µ

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞

#### **–§–∞–π–ª: `server/routes/dashboard.js`**

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (nickname + password) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω:

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è credentials
// (—Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ø–∞–¥–∞–µ—Ç —Å—é–¥–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã)
console.log('üîì [DASHBOARD] –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è credentials...');
try {
  const { error: unlockError } = await supabase
    .from('primary_test_results')
    .update({ personal_plan_unlocked: true })
    .eq('session_id', sessionId);
  
  if (unlockError) {
    console.error('‚ö†Ô∏è [DASHBOARD] –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞:', unlockError);
  } else {
    console.log('‚úÖ [DASHBOARD] –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω');
  }
} catch (unlockErr) {
  console.error('‚ö†Ô∏è [DASHBOARD] –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–µ:', unlockErr);
}
```

#### **–§–∞–π–ª: `server/routes/payments.js`**

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:

**A. –í endpoint –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞ (`/status/:paymentId`)**

```javascript
if (status === 'CONFIRMED') {
  console.log('‚úÖ –ü–ª–∞—Ç–µ–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω...');
  
  // –ü–æ–ª—É—á–∞–µ–º sessionId –∏–∑ —Ç–∞–±–ª–∏—Ü—ã payments
  const { data: payment, error: paymentError } = await supabase
    .from('payments')
    .select('session_id')
    .eq('payment_id', paymentId)
    .single();
  
  if (!paymentError && payment) {
    const sessionId = payment.session_id;
    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω
    await supabase
      .from('primary_test_results')
      .update({ personal_plan_unlocked: true })
      .eq('session_id', sessionId);
  }
}
```

**B. –í webhook –æ—Ç –¢–∏–Ω—å–∫–æ—Ñ—Ñ (`/webhook`)**

```javascript
if (Status === 'CONFIRMED') {
  // –ü–æ–ª—É—á–∞–µ–º sessionId –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω
  const { data: payment } = await supabase
    .from('payments')
    .select('session_id')
    .eq('payment_id', PaymentId)
    .single();
  
  if (payment) {
    await supabase
      .from('primary_test_results')
      .update({ personal_plan_unlocked: true })
      .eq('session_id', payment.session_id);
  }
}
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞

#### **–§–∞–π–ª: `server/routes/ai.js`**

**A. –í endpoint –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –º–∞—Å–∫–æ—Ç–∞ (`/mascot-message/dashboard`)**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞
if (!primaryTest.answers || (Array.isArray(primaryTest.answers) && primaryTest.answers.length === 0)) {
  console.log('‚ö†Ô∏è –û—Ç–≤–µ—Ç—ã —Ç–µ—Å—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –ø—É—Å—Ç—ã –¥–ª—è sessionId:', sessionId);
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ AI
  const defaultMessage = '–ü—Ä–∏–≤–µ—Ç! –Ø –õ—É–º–∏, —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è. üåü\n\n' +
    '–ß—Ç–æ–±—ã —è –º–æ–≥ –ø–æ–¥–æ–±—Ä–∞—Ç—å –¥–ª—è —Ç–µ–±—è –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, ' +
    '—Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –º–Ω–µ –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Ç–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é –∏ ' +
    '–ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–≤–æ–µ–≥–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.';
  
  return res.json({ 
    success: true, 
    message: defaultMessage,
    recommendedTests: [],
    cached: false,
    warning: 'Primary test not completed'
  });
}
```

**B. –í endpoint –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ (`/personal-plan`)**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ—à–∏–±–∫–∏:

```javascript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞
if (!primaryTest.answers || (Array.isArray(primaryTest.answers) && primaryTest.answers.length === 0)) {
  console.error('‚ùå [PERSONAL-PLAN] –û—Ç–≤–µ—Ç—ã —Ç–µ—Å—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–ª—è sessionId:', sessionId);
  return res.status(400).json({ 
    success: false, 
    error: 'Primary test not completed',
    message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ'
  });
}
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
console.log('üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –∏–∑ –ë–î:', primaryTest);
console.log('üîç –ï—Å—Ç—å –ª–∏ –æ—Ç–≤–µ—Ç—ã (answers)?', !!primaryTest?.answers);
console.log('üîç –¢–∏–ø answers:', typeof primaryTest?.answers);
```

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—à–µ–ª —Ç–µ—Å—Ç ‚Üí –æ–ø–ª–∞—Ç–∏–ª ‚Üí –≤–æ—à–µ–ª –≤ –õ–ö

1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç ‚Üí `answers` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
2. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç ‚Üí —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ `CONFIRMED`
3. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç nickname + password ‚Üí `personal_plan_unlocked = true`
4. ‚úÖ –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –õ–ö:
   - –ú–∞—Å–∫–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Gemini
   - AI –ø–æ–¥–±–∏—Ä–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤
   - –î–æ—Å—Ç—É–ø–µ–Ω –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—Ç–∏–ª –ë–ï–ó –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞

1. ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –±–µ–∑ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
2. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç nickname + password ‚Üí `personal_plan_unlocked = true`
3. ‚úÖ –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –õ–ö:
   - –ú–∞—Å–∫–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—å–±–æ–π –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
   - –°–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –ø—É—Å—Ç
   - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Webhook –æ—Ç –¢–∏–Ω—å–∫–æ—Ñ—Ñ –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–æ–∑–∂–µ

1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç
2. üîî Webhook –æ—Ç –¢–∏–Ω—å–∫–æ—Ñ—Ñ —Å `Status = CONFIRMED` ‚Üí `personal_plan_unlocked = true`
3. ‚úÖ –î–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ–∑–¥–∞–ª credentials, –ø–ª–∞–Ω —É–∂–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
4. ‚úÖ –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ –õ–ö –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìä –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **`server/routes/dashboard.js`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ –≤ `/create-credentials`

2. **`server/routes/payments.js`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤ `/status/:paymentId`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤ `/webhook`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

3. **`server/routes/ai.js`**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ `/mascot-message/dashboard`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤ `/personal-plan`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üöÄ –î–µ–ø–ª–æ–π

**–î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:**

```bash
git add .
git commit -m "fix: —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è answers"
git push origin main
```

**Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è**

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É —Å —Ç–µ—Å—Ç–æ–º

1. –ü—Ä–æ–π–¥–∏—Ç–µ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
2. –û–ø–ª–∞—Ç–∏—Ç–µ 1 ‚ÇΩ
3. –°–æ–∑–¥–∞–π—Ç–µ nickname + password
4. –í–æ–π–¥–∏—Ç–µ –≤ –õ–ö
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –ú–∞—Å–∫–æ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

### –¢–µ—Å—Ç 2: –û–ø–ª–∞—Ç–∞ –±–µ–∑ —Ç–µ—Å—Ç–∞

1. –ù–ï –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–ø–ª–∞—Ç–∏—Ç—å (—Å–æ–∑–¥–∞–π—Ç–µ sessionId –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π —Ñ–ª–æ—É)
3. –°–æ–∑–¥–∞–π—Ç–µ nickname + password
4. –í–æ–π–¥–∏—Ç–µ –≤ –õ–ö
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - –ú–∞—Å–∫–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
   - –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤ –ø—É—Å—Ç
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞

### –¢–µ—Å—Ç 3: Webhook

1. –û–ø–ª–∞—Ç–∏—Ç–µ 1 ‚ÇΩ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é –æ–ø–ª–∞—Ç—É)
2. –î–æ–∂–¥–∏—Ç–µ—Å—å webhook –æ—Ç –¢–∏–Ω—å–∫–æ—Ñ—Ñ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
   ```
   üîî –ü–æ–ª—É—á–µ–Ω webhook –æ—Ç –¢–∏–Ω—å–∫–æ—Ñ—Ñ: { Status: 'CONFIRMED', ... }
   ‚úÖ –ü–ª–∞—Ç–µ–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω...
   üîì –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è sessionId: ...
   ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ webhook
   ```
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ë–î: `personal_plan_unlocked = true`

## üìù –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üì• POST /api/dashboard/create-credentials
‚úÖ [DASHBOARD] –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è —Å–µ—Å—Å–∏–∏: ...
üîì [DASHBOARD] –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è credentials...
‚úÖ [DASHBOARD] –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

üì• POST /api/ai/mascot-message/dashboard
üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –∏–∑ –ë–î: { answers: [...], email: null, ... }
üîç –ï—Å—Ç—å –ª–∏ –æ—Ç–≤–µ—Ç—ã (answers)? true
üîç –¢–∏–ø answers: object
üöÄ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ Gemini AI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è...
‚úÖ Gemini API –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω, –¥–ª–∏–Ω–∞: 342 —Å–∏–º–≤–æ–ª–æ–≤
üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –õ—É–º–∏ –≤ –ë–î...
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –õ—É–º–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î
```

–ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞:

```
üì• POST /api/ai/mascot-message/dashboard
üîç –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –∏–∑ –ë–î: { answers: null, email: null, ... }
üîç –ï—Å—Ç—å –ª–∏ –æ—Ç–≤–µ—Ç—ã (answers)? false
üîç –¢–∏–ø answers: object
‚ö†Ô∏è –û—Ç–≤–µ—Ç—ã —Ç–µ—Å—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –ø—É—Å—Ç—ã –¥–ª—è sessionId: ...
```

## ‚úÖ –†–µ–∑—é–º–µ

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

1. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞** –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã (—á–µ—Ä–µ–∑ 3 —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞)
2. ‚úÖ **Graceful –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Ç–µ—Å—Ç–∞** —Å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
3. ‚úÖ **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏
4. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö

Gemini API —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:
- ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–∞—Å–∫–æ—Ç–∞
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Ç–µ—Å—Ç–∞–º
- ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è

