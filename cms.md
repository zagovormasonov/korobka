# CMS ‚Äî –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª CMS-–ø–∞–Ω–µ–ª–∏** –ø—Ä–æ–µ–∫—Ç–∞ idenself (–∫–æ—Ä–æ–±–∫–∞). –ò—Å–ø–æ–ª—å–∑—É–π –µ–≥–æ –∫–∞–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è CMS –≤ –¥—Ä—É–≥–æ–º –ø—Ä–æ–µ–∫—Ç–µ.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–§—Ä–µ–π–º–≤–æ—Ä–∫ —Å–µ—Ä–≤–µ—Ä–∞:** Express.js (ESM-–º–æ–¥—É–ª–∏, `import/export`)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** Supabase (PostgreSQL)
- **–†–µ–∞–ª-—Ç–∞–π–º:** Socket.IO (WebSocket)
- **–§—Ä–æ–Ω—Ç–µ–Ω–¥ CMS:** React + TypeScript, Ant Design (UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã), Recharts (–≥—Ä–∞—Ñ–∏–∫–∏)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** Bearer-—Ç–æ–∫–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ä–æ–ª—è
- **–ü–æ—Ä—Ç:** 5000 (–∏–ª–∏ `process.env.PORT`)

---

## 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è |
|---|---|---|
| `SUPABASE_URL` | URL Supabase –ø—Ä–æ–µ–∫—Ç–∞ | –î–∞ |
| `SUPABASE_SERVICE_ROLE_KEY` | –°–µ—Ä–≤–∏—Å–Ω—ã–π –∫–ª—é—á Supabase | –î–∞ |
| `CMS_PASSWORD` | –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –≤ CMS (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `admin_korobka_2025`) | –ù–µ—Ç |
| `FRONTEND_URL` | URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ | –ù–µ—Ç |
| `TELEGRAM_CHAT_ID` | ID —á–∞—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö | –ù–µ—Ç |

---

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Supabase)

### –¢–∞–±–ª–∏—Ü–∞ `primary_test_results`
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | serial | Primary key |
| `session_id` | text (unique) | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `answers` | jsonb | –ú–∞—Å—Å–∏–≤ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç (45 –≤–æ–ø—Ä–æ—Å–æ–≤) |
| `email` | text | Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `nickname` | text | –ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `dashboard_token` | text | –¢–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É |
| `dashboard_password` | text | –ü–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É |
| `personal_plan` | text | –¢–µ–∫—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ |
| `personal_plan_unlocked` | boolean | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω (–æ–ø–ª–∞—á–µ–Ω) |
| `session_preparation_generated` | boolean | –§–ª–∞–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Å–µ–∞–Ω—Å—É |
| `psychologist_pdf_generated` | boolean | –§–ª–∞–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ |
| `created_at` | timestamptz | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | timestamptz | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –¢–∞–±–ª–∏—Ü–∞ `analytics_events`
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | serial | Primary key |
| `session_id` | text | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏ |
| `event_type` | text | –¢–∏–ø —Å–æ–±—ã—Ç–∏—è |
| `page_url` | text | URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã |
| `metadata` | jsonb | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `created_at` | timestamptz | –î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è |

**–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π (`event_type`):**
- `page_visit` ‚Äî –ø–æ—Å–µ—â–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `test_start` ‚Äî –Ω–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞
- `test_question` ‚Äî –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å (metadata: `{ question_number, progress_percent }`)
- `test_complete` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞
- `payment_init` ‚Äî –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
- `payment_success` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `plan_unlocked` ‚Äî —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–ª–∞–Ω–∞
- `pdf_download` ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ PDF (metadata: `{ pdf_type, pdf_number }`)
- `psychologist_request` ‚Äî –∑–∞—è–≤–∫–∞ –Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞
- `feedback_sent` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
- `heartbeat` ‚Äî –ø—É–ª—å—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫, metadata: `{ socket_id }`)

**–ò–Ω–¥–µ–∫—Å—ã:** –Ω–∞ `session_id`, `event_type`, `created_at`.

### –¢–∞–±–ª–∏—Ü–∞ `additional_test_results`
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | serial | Primary key |
| `session_id` | text | FK ‚Üí `primary_test_results` (CASCADE delete) |
| `test_type` | text | –¢–∏–ø —Ç–µ—Å—Ç–∞ |
| `test_name` | text | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ |
| `test_result` | text | –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞ |
| `answers` | jsonb | –û—Ç–≤–µ—Ç—ã |
| `created_at` | timestamptz | –î–∞—Ç–∞ |
| `updated_at` | timestamptz | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –¢–∞–±–ª–∏—Ü–∞ `payments`
| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | serial | Primary key |
| `session_id` | text | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏ |
| `payment_id` | text | ID –ø–ª–∞—Ç–µ–∂–∞ |
| `amount` | numeric | –°—É–º–º–∞ |
| `status` | text | –°—Ç–∞—Ç—É—Å (`succeeded`, `pending`, `failed`) |
| `created_at` | timestamptz | –î–∞—Ç–∞ |
| `updated_at` | timestamptz | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

---

## 3. –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å CMS

### –§–∞–π–ª: `server/routes/cms.js`

–ú–∞—Ä—à—Ä—É—Ç—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –≤ `server/index.js`:
```javascript
import cmsRoutes from './routes/cms.js';
app.use('/api/cms', cmsRoutes);
```

### 3.1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**Middleware `checkAuth`:**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <token>`. –¢–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å `CMS_PASSWORD`.

**`POST /api/cms/auth`** ‚Äî –í—Ö–æ–¥ –≤ CMS
- Payload: `{ "password": "string" }`
- –£—Å–ø–µ—Ö: `{ "success": true, "token": "string" }` ‚Äî —Ç–æ–∫–µ–Ω = —Å–∞–º –ø–∞—Ä–æ–ª—å
- –û—à–∏–±–∫–∞ (401): `{ "success": false, "error": "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å" }`

### 3.2. –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**`GET /api/cms/stats/basic`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 4 —Å—á—ë—Ç—á–∏–∫–∞:
```json
{
  "success": true,
  "stats": {
    "totalUsers": 150,
    "completedTests": 120,
    "unlockedPlans": 45,
    "successfulPayments": 42
  }
}
```

–õ–æ–≥–∏–∫–∞:
- `totalUsers` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ `primary_test_results`
- `completedTests` ‚Äî –∑–∞–ø–∏—Å–∏ –≥–¥–µ `answers IS NOT NULL`
- `unlockedPlans` ‚Äî –∑–∞–ø–∏—Å–∏ –≥–¥–µ `personal_plan_unlocked = true`
- `successfulPayments` ‚Äî –∑–∞–ø–∏—Å–∏ –≤ `payments` –≥–¥–µ `status = 'succeeded'`

### 3.3. –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Ä–µ–∞–ª-—Ç–∞–π–º)

**`GET /api/cms/stats/active`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ WebSocket-—Å–µ—Ä–≤–µ—Ä–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î):
```json
{
  "success": true,
  "activeUsers": 5,
  "onlineSessionIds": ["sess_abc", "sess_def", "..."],
  "source": "websocket"
}
```

### 3.4. –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã—Ö –¥–∏–∞–≥–Ω–æ–∑–æ–≤

**`GET /api/cms/stats/diagnosis`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ 1000 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–Ω–∫–µ—Ç. –§—É–Ω–∫—Ü–∏—è `analyzeDiagnosis(answers)` –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –±–∞–ª–ª—ã –ø–æ 10 –¥–∏–∞–≥–Ω–æ–∑–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ê–ª–≥–æ—Ä–∏—Ç–º —Å–∫–æ—Ä–∏–Ω–≥–∞:**

| –î–∏–∞–≥–Ω–æ–∑ | –í–æ–ø—Ä–æ—Å—ã | –ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|---|---|---|
| –ü–†–õ (–ü–æ–≥—Ä–∞–Ω–∏—á–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ) | 4, 17, 19, 22, 26, 38 (yes = +1.5), 19, 22 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 4 |
| –î–µ–ø—Ä–µ—Å—Å–∏—è | 2, 3, 18 (yes = +1.5), 25, 27, 29 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –¢—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | 5, 12, 21 (yes = +1.5), 5, 12 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | 2, 18 (yes = +2), 2 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –°–î–í–ì | 3, 11, 16 (yes = +2), 3, 11 (—á–∏—Å–ª–æ ‚â•6 = +1) | ‚â• 3 |
| –ü–¢–°–† | 6, 34 (yes = +2), 6 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –û–ö–† | 13 (yes = +3), 13 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –†–ü–ü | 7 (yes = +3), 7 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–µ—â–µ—Å—Ç–≤ | 8, 32 (yes = +2) | ‚â• 2 |
| –î–∏—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | 14, 25 (yes = +2), 14 (—á–∏—Å–ª–æ ‚â•7 = +1) | ‚â• 3 |

**–ö–æ–º–æ—Ä–±–∏–¥–Ω–æ—Å—Ç—å:** –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –ü–†–õ ‚Äî % —Å–æ—á–µ—Ç–∞–Ω–∏—è —Å –î–µ–ø—Ä–µ—Å—Å–∏–µ–π, –¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å—é, –†–ü–ü.

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "totalAnalyzed": 150,
  "distribution": [
    { "name": "–ü–†–õ (–ü–æ–≥—Ä–∞–Ω–∏—á–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)", "value": 45, "color": "#FF8042" },
    { "name": "–î–µ–ø—Ä–µ—Å—Å–∏—è", "value": 80, "color": "#0088FE" },
    { "name": "–¢—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", "value": 65, "color": "#00C49F" },
    { "name": "–ë–ê–† (–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)", "value": 12, "color": "#FFBB28" },
    { "name": "–°–î–í–ì", "value": 30, "color": "#8DD1E1" },
    { "name": "–ü–¢–°–†", "value": 25, "color": "#A4DE6C" },
    { "name": "–û–ö–†", "value": 10, "color": "#D0ED57" },
    { "name": "–†–ü–ü", "value": 15, "color": "#FFC658" },
    { "name": "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–µ—â–µ—Å—Ç–≤", "value": 8, "color": "#FF6B9D" },
    { "name": "–î–∏—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", "value": 5, "color": "#C3AED6" },
    { "name": "–ë–µ–∑ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤", "value": 20, "color": "#8884d8" }
  ],
  "correlations": [
    { "name": "–ü–†–õ + –î–µ–ø—Ä–µ—Å—Å–∏—è", "value": 72 },
    { "name": "–ü–†–õ + –¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å", "value": 60 },
    { "name": "–ü–†–õ + –†–ü–ü", "value": 35 }
  ]
}
```

### 3.5. –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

**`GET /api/cms/stats/detailed-funnel`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- Query: `?period=all|day|week|month`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 51+ —ç—Ç–∞–ø–æ–≤ –≤–æ—Ä–æ–Ω–∫–∏: –Ω–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞ ‚Üí 45 –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Üí –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ ‚Üí –æ–ø–ª–∞—Ç–∞ ‚Üí –ø–ª–∞–Ω ‚Üí 3 PDF ‚Üí –∑–∞—è–≤–∫–∞ –Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞ ‚Üí –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å.

–õ–æ–≥–∏–∫–∞:
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è **—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ** `session_id`
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ: `day` = –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24—á, `week` = 7 –¥–Ω–µ–π, `month` = 30 –¥–Ω–µ–π
- –í–æ–ø—Ä–æ—Å—ã 1-45 –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ `metadata.question_number` –≤ —Å–æ–±—ã—Ç–∏—è—Ö `test_question`
- PDF —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ `metadata.pdf_number` (1, 2, 3)

```json
{
  "success": true,
  "period": "all",
  "funnel": [
    { "step": "–ù–∞—á–∞–ª–∏ —Ç–µ—Å—Ç", "users": 150, "stage": "test_start" },
    { "step": "–í–æ–ø—Ä–æ—Å 1", "users": 148, "stage": "question_1" },
    { "step": "–í–æ–ø—Ä–æ—Å 2", "users": 140, "stage": "question_2" },
    "... (–≤–æ–ø—Ä–æ—Å—ã 3-45)",
    { "step": "–ó–∞–≤–µ—Ä—à–∏–ª–∏ —Ç–µ—Å—Ç –∏ –ø–æ–ø–∞–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã", "users": 100, "stage": "test_complete" },
    { "step": "–ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª–∏ –æ–ø–ª–∞—Ç—É", "users": 55, "stage": "payment_init" },
    { "step": "–û–ø–ª–∞—Ç–∏–ª–∏", "users": 42, "stage": "payment_success" },
    { "step": "–ü–æ–ª—É—á–∏–ª–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω", "users": 40, "stage": "plan_unlocked" },
    { "step": "–°–∫–∞—á–∞–ª–∏ 1 PDF", "users": 35, "stage": "pdf_1" },
    { "step": "–°–∫–∞—á–∞–ª–∏ 2 PDF", "users": 20, "stage": "pdf_2" },
    { "step": "–°–∫–∞—á–∞–ª–∏ –≤—Å–µ 3 PDF", "users": 10, "stage": "pdf_3" },
    { "step": "–û—Å—Ç–∞–≤–∏–ª–∏ –∑–∞—è–≤–∫—É –Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞", "users": 5, "stage": "psychologist" },
    { "step": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å", "users": 3, "stage": "feedback" }
  ],
  "totalSteps": 51
}
```

### 3.6. –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ (—Å fallback)

**`GET /api/cms/stats/funnel`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- Query: `?period=all|day|week|month`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 3 —ç—Ç–∞–ø–∞. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `analytics_events` –ø—É—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback –Ω–∞ `primary_test_results`.

```json
{
  "success": true,
  "period": "all",
  "source": "analytics_events",
  "funnel": [
    { "name": "–ù–∞—á–∞–ª–∏ —Ç–µ—Å—Ç", "value": 150, "fill": "#8884d8" },
    { "name": "–ó–∞–≤–µ—Ä—à–∏–ª–∏ —Ç–µ—Å—Ç", "value": 100, "fill": "#83a6ed" },
    { "name": "–ö—É–ø–∏–ª–∏ –ø–ª–∞–Ω", "value": 42, "fill": "#82ca9d" }
  ]
}
```

### 3.7. –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

**`GET /api/cms/users`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ –≤–æ—Ä–æ–Ω–∫–∏, –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–æ–º –∏ –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π –∞–Ω–æ–Ω–∏–º–æ–≤.

–õ–æ–≥–∏–∫–∞:
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `primary_test_results` (–ø–æ —É–±—ã–≤–∞–Ω–∏—é `created_at`)
- –û–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å –∏–∑ WebSocket (`getOnlineUsers()`)
- –ü—Ä–æ–≥—Ä–µ—Å—Å –≤–æ—Ä–æ–Ω–∫–∏ –∏–∑ `analytics_events` (—Å–æ–±—ã—Ç–∏—è `test_start`, `test_complete`, `payment_success`, `test_question`)
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç ‚Äî —Å–∞–º–æ–µ —Å–≤–µ–∂–µ–µ —Å–æ–±—ã—Ç–∏–µ –≤ `analytics_events`
- –ù—É–º–µ—Ä–∞—Ü–∏—è –∞–Ω–æ–Ω–∏–º–æ–≤: –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ `nickname` –ø–æ–ª—É—á–∞—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è ("–ê–Ω–æ–Ω–∏–º 1", "–ê–Ω–æ–Ω–∏–º 2" –∏ —Ç.–¥.)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤: –∏–∑ `answers.length` (–µ—Å–ª–∏ –µ—Å—Ç—å) –∏–ª–∏ –∏–∑ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π `test_question`

```json
{
  "success": true,
  "users": [
    {
      "sessionId": "sess_abc123",
      "nickname": "–ò–≤–∞–Ω",
      "hasPassword": true,
      "password": "mypass123",
      "createdAt": "2025-01-15T10:00:00Z",
      "updatedAt": "2025-01-15T12:00:00Z",
      "lastVisit": "2025-01-15T14:30:00Z",
      "isOnline": true,
      "personalPlanUnlocked": true,
      "funnel": {
        "started": true,
        "questionsAnswered": 45,
        "totalQuestions": 45,
        "completed": true,
        "paid": true
      }
    }
  ],
  "total": 150,
  "online": 3
}
```

### 3.8. –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**`GET /api/cms/users/:sessionId/data`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç (—Å —Ç–µ–∫—Å—Ç–∞–º–∏ –≤–æ–ø—Ä–æ—Å–æ–≤), —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–ø. —Ç–µ—Å—Ç–æ–≤, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω, –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ —Å–µ–∞–Ω—Å—É, –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.

–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –∏–∑ 46 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ (id, text, type) –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∫ —Ç–µ–∫—Å—Ç–∞–º –≤–æ–ø—Ä–æ—Å–æ–≤.

```json
{
  "success": true,
  "data": {
    "primaryTestAnswers": [
      {
        "questionId": 1,
        "questionText": "–í –∫–∞–∫–æ–º —Ä–æ–¥–µ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?",
        "answer": "–º—É–∂—Å–∫–æ–π",
        "additionalText": null
      }
    ],
    "additionalTestsResults": [
      {
        "testName": "–¢–µ—Å—Ç –Ω–∞ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å",
        "testType": "anxiety",
        "result": "–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏"
      }
    ],
    "personalPlan": "Markdown-—Ç–µ–∫—Å—Ç –ø–ª–∞–Ω–∞...",
    "sessionPreparation": null,
    "psychologistDocument": null
  }
}
```

### 3.9. –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**`DELETE /api/cms/users/:sessionId`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:
1. –£–¥–∞–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ `analytics_events` (–≤—Ä—É—á–Ω—É—é, –Ω–µ—Ç CASCADE)
2. –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –∏–∑ `primary_test_results` (CASCADE —É–¥–∞–ª–∏—Ç `additional_test_results`, `payments`)

```json
{
  "success": true,
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã"
}
```

### 3.10. –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

**`GET /api/cms/stats/activity-by-hour`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- Query: `?period=day|week|month&pages=all|homepage,test,dashboard,other&date=YYYY-MM-DD&metricType=active_users|new_users|conversion_rate`

–¢—Ä–∏ —Ä–µ–∂–∏–º–∞ –º–µ—Ç—Ä–∏–∫:
1. **`active_users`** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ `heartbeat` —Å–æ–±—ã—Ç–∏–π. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º: `homepage` (/), `test` (/test*, /bpd-test*), `dashboard` (/dashboard*, /personal-plan*, /feedback-chat*), `other`.
2. **`new_users`** ‚Äî –ø–µ—Ä–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ `test_start` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ `session_id`.
3. **`conversion_rate`** ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç `payment_success` –æ—Ç `test_start` (% –∫–æ–Ω–≤–µ—Ä—Å–∏–∏).

–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ **–º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è (UTC+3)**.

–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:
- `day` ‚Äî –ø–æ —á–∞—Å–∞–º (0-23)
- `week` ‚Äî –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ (–ü–Ω-–í—Å, –ü–Ω = 0)
- `month` ‚Äî –ø–æ –¥–Ω—è–º –º–µ—Å—è—Ü–∞ (1-31)

–ù–∞–≤–∏–≥–∞—Ü–∏—è: –≤—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∞—Ç—ã, —Å—Ç—Ä–µ–ª–∫–∏ –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥, –∫–Ω–æ–ø–∫–∞ "–°–µ–≥–æ–¥–Ω—è".

```json
{
  "success": true,
  "data": [
    { "index": 0, "label": "0:00", "users": 2 },
    { "index": 1, "label": "1:00", "users": 0 },
    "..."
  ],
  "period": "day",
  "totalEvents": 1200
}
```

### 3.11. –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**`GET /api/cms/stats/heatmap`** (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–ú–∞—Ç—Ä–∏—Ü–∞ 7 –¥–Ω–µ–π √ó 24 —á–∞—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ `heartbeat` —Å–æ–±—ã—Ç–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π. –í–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ.

```json
{
  "success": true,
  "heatmap": [
    { "day": "–ü–Ω", "hour": 0, "users": 1 },
    { "day": "–ü–Ω", "hour": 1, "users": 0 },
    "... (–≤—Å–µ–≥–æ 168 —Ç–æ—á–µ–∫: 7 √ó 24)"
  ],
  "prediction": {
    "peakHours": ["14:00", "20:00", "15:00"],
    "bestMaintenanceTime": ["4:00", "5:00", "3:00"],
    "avgUsersPerHour": 2.5
  }
}
```

–õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è:
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –≤—Å–µ –¥–Ω–∏, –∫–æ–≥–¥–∞ –±—ã–ª–∏ –¥–∞–Ω–Ω—ã–µ
- –¢–æ–ø-3 —á–∞—Å–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Å—Ä–µ–¥–Ω–µ–π = –ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã
- –¢–æ–ø-3 —á–∞—Å–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π —Å—Ä–µ–¥–Ω–µ–π = –ª—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ç–µ—Ö—Ä–∞–±–æ—Ç

---

## 4. WebSocket-—Å–µ—Ä–≤–µ—Ä (—Ä–µ–∞–ª-—Ç–∞–π–º)

### –§–∞–π–ª: `server/websocket.js`

–•—Ä–∞–Ω–∏–ª–∏—â–µ: `Map<sessionId, { socketId, lastSeen, page }>` (–≤ –ø–∞–º—è—Ç–∏).

**–°–æ–±—ã—Ç–∏—è –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞:**

| –°–æ–±—ã—Ç–∏–µ | –î–∞–Ω–Ω—ã–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `user_online` | `{ sessionId, page }` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à—ë–ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É |
| `heartbeat` | `{ sessionId, page }` | –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫) |

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/chat` –∏ `/cms` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

**–°–æ–±—ã—Ç–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (broadcast):**

| –°–æ–±—ã—Ç–∏–µ | –î–∞–Ω–Ω—ã–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `online_count` | `number` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `online_users_update` | `string[]` | –ú–∞—Å—Å–∏–≤ `sessionId` –æ–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

**–û—á–∏—Å—Ç–∫–∞:** –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥ —É–¥–∞–ª—è—é—Ç—Å—è —Å–µ—Å—Å–∏–∏ –±–µ–∑ `heartbeat` –±–æ–ª–µ–µ 2 –º–∏–Ω—É—Ç.

**–ü—Ä–∏ `user_online`:** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è heartbeat-—Å–æ–±—ã—Ç–∏–µ –≤ `analytics_events` (–¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤).

**–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```javascript
export function getOnlineUsers(): string[]   // –ú–∞—Å—Å–∏–≤ sessionId
export function getOnlineCount(): number     // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
```

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ `server/index.js`:
```javascript
import { createServer } from 'http';
import { initializeWebSocket } from './websocket.js';

const httpServer = createServer(app);
const io = initializeWebSocket(httpServer);
httpServer.listen(PORT, '0.0.0.0');
```

---

## 5. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (—Ç—Ä–µ–∫–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π)

### –§–∞–π–ª: `server/routes/analytics.js`

**`POST /api/analytics/track`** ‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏—è
- Payload: `{ "sessionId": "string", "eventType": "string", "pageUrl": "string?", "metadata": {} }`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ `analytics_events`
- –ü—Ä–∏ `test_start`: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ `primary_test_results` (–µ—Å–ª–∏ –Ω–µ—Ç) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

---

## 6. –§—Ä–æ–Ω—Ç–µ–Ω–¥ CMS

### –§–∞–π–ª: `src/pages/CMSPage.tsx`

### 6.1. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

```typescript
// UI
import { Typography, Card, Statistic, Row, Col, Layout, Menu, Input, Button, 
         message, Spin, List, Select, Table, Tag, Space, Tooltip, Switch, 
         Checkbox, DatePicker, Modal } from 'antd';
// –ì—Ä–∞—Ñ–∏–∫–∏
import { PieChart, Pie, Cell, BarChart, Bar, LineChart, Line, XAxis, YAxis, 
         CartesianGrid, Tooltip as ChartTooltip, Legend, ResponsiveContainer } from 'recharts';
// –ò–∫–æ–Ω–∫–∏
import { UserOutlined, DashboardOutlined, LineChartOutlined, ThunderboltOutlined,
         EyeOutlined, EyeInvisibleOutlined, CheckCircleOutlined, CloseCircleOutlined,
         LeftOutlined, RightOutlined, DeleteOutlined } from '@ant-design/icons';
// –î–∞—Ç—ã
import dayjs from 'dayjs';
import 'dayjs/locale/ru';
// WebSocket
import { io, Socket } from 'socket.io-client';
```

### 6.2. –ú–∞—Ä—à—Ä—É—Ç

CMS –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É `/cms` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `App.tsx`).

### 6.3. –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞

- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É —ç–∫—Ä–∞–Ω–∞ —Å –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è (`Input.Password`)
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Enter –∏–ª–∏ –∫–Ω–æ–ø–∫–∏ "–í–æ–π—Ç–∏" ‚Üí `POST /api/cms/auth`
- –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `localStorage` –∫–∞–∫ `cms_token`
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ `localStorage`

### 6.4. –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**Layout:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–æ–∫–æ–≤–æ–π Sider (250px) —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º, –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –∏ –∫–Ω–æ–ø–∫–æ–π –≤—ã—Ö–æ–¥–∞
- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º —Å–∫—Ä–æ–ª–ª–æ–º
- –í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É ‚Äî –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–°–µ–π—á–∞—Å –Ω–∞ —Å–∞–π—Ç–µ: N —á–µ–ª."

**–ù–∞–≤–∏–≥–∞—Ü–∏—è (4 –≤–∫–ª–∞–¥–∫–∏):**
1. **–û–±–∑–æ—Ä –∏ –ú–µ—Ç—Ä–∏–∫–∏** (`overview`)
2. **–í–æ—Ä–æ–Ω–∫–∞** (`funnel`)
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** (`users`)
4. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å** (`roadmap`)

–ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `localStorage` (`cms_active_tab`).

### 6.5. –í–∫–ª–∞–¥–∫–∞ ¬´–û–±–∑–æ—Ä –∏ –ú–µ—Ç—Ä–∏–∫–∏¬ª

**–ë–ª–æ–∫ 1 ‚Äî –°—á—ë—Ç—á–∏–∫ –ø–ª–∞–Ω–æ–≤ + –ú–∏–Ω–∏-–≤–æ—Ä–æ–Ω–∫–∞:**
- –°–ª–µ–≤–∞: –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ (72px) + –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏–∑ –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∞ –≤ –ø–æ–∫—É–ø–∫—É
- –°–ø—Ä–∞–≤–∞: –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (BarChart) —Å 3 —ç—Ç–∞–ø–∞–º–∏

**–ë–ª–æ–∫ 2 ‚Äî –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**
- –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –º–µ—Ç—Ä–∏–∫ (–≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∫–∞—Ä—Ç–æ—á–∫–∏):
  - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (heartbeat)
  - –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–ø–µ—Ä–≤—ã–π test_start)
  - –î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (% payment_success –æ—Ç test_start)
- –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞: –∑–∞ —Å—É—Ç–∫–∏ (—á–∞—Å—ã) / –∑–∞ –Ω–µ–¥–µ–ª—é (–¥–Ω–∏) / –∑–∞ –º–µ—Å—è—Ü (–¥–∞—Ç—ã)
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º: —Å—Ç—Ä–µ–ª–∫–∏ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ, DatePicker, –∫–Ω–æ–ø–∫–∞ "–°–µ–≥–æ–¥–Ω—è"
- –§–∏–ª—å—Ç—Ä—ã –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (—Ç–æ–ª—å–∫–æ –¥–ª—è "–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å"): –ì–ª–∞–≤–Ω–∞—è, –¢–µ—Å—Ç, –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –û—Å—Ç–∞–ª—å–Ω—ã–µ
- –õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (LineChart) —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º tooltip

**–ë–ª–æ–∫ 3 ‚Äî –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞:**
- HTML-—Ç–∞–±–ª–∏—Ü–∞ 7√ó24 (–¥–Ω–∏ √ó —á–∞—Å—ã)
- –¶–≤–µ—Ç —è—á–µ–π–∫–∏: –æ—Ç —Å–≤–µ—Ç–ª–æ-—Å–µ—Ä–æ–≥–æ (0 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –¥–æ —Ç—ë–º–Ω–æ-—Å–∏–Ω–µ–≥–æ (–º–∞–∫—Å–∏–º—É–º)
- –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å: `rgba(24, 144, 255, 0.2 + intensity * 0.8)`

**–ë–ª–æ–∫ 4 ‚Äî –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ö–∞—Ä—Ç–æ—á–∫–∞ "–ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏" ‚Äî —Ç–æ–ø-3 —á–∞—Å–∞ —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Å—Ä–µ–¥–Ω–µ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
- –ö–∞—Ä—Ç–æ—á–∫–∞ "–õ—É—á—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Ç–µ—Ö—Ä–∞–±–æ—Ç" ‚Äî —Ç–æ–ø-3 —á–∞—Å–∞ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π

**–ë–ª–æ–∫ 5 ‚Äî –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ–∑–æ–≤:**
- –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (PieChart) —Å –ª–µ–π–±–ª–∞–º–∏ "–ù–∞–∑–≤–∞–Ω–∏–µ N%"
- 11 —Å–µ–∫—Ç–æ—Ä–æ–≤ (10 –¥–∏–∞–≥–Ω–æ–∑–æ–≤ + "–ë–µ–∑ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")

### 6.6. –í–∫–ª–∞–¥–∫–∞ ¬´–í–æ—Ä–æ–Ω–∫–∞¬ª

- –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (BarChart, layout="vertical")
- –í—ã—Å–æ—Ç–∞ –≥—Ä–∞—Ñ–∏–∫–∞: `max(1200, funnelData.length * 20)` –ø–∏–∫—Å–µ–ª–µ–π
- –§–∏–ª—å—Ç—Ä –ø–æ –ø–µ—Ä–∏–æ–¥—É (Select): –ó–∞ –≤—Å—ë –≤—Ä–µ–º—è / –ó–∞ –º–µ—Å—è—Ü / –ó–∞ –Ω–µ–¥–µ–ª—é / –ó–∞ –¥–µ–Ω—å
- –¶–≤–µ—Ç–æ–≤–∞—è –≥—Ä–∞–¥–∞—Ü–∏—è: HSL –æ—Ç —Å–∏–Ω–µ–≥–æ –∫ –∑–µ–ª—ë–Ω–æ–º—É –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è
- –ö–∞—Å—Ç–æ–º–Ω—ã–π tooltip: –Ω–∞–∑–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞ + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ + % –æ—Ç –Ω–∞—á–∞–ª–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–Ω–∏–∑—É: 3 –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (–Ω–∞—á–∞–ª–æ‚Üí–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –Ω–∞—á–∞–ª–æ‚Üí–ø–æ–∫—É–ø–∫–∞, –Ω–∞—á–∞–ª–æ‚Üí–ø–æ–ª–Ω—ã–π –æ–ø—ã—Ç)

### 6.7. –í–∫–ª–∞–¥–∫–∞ ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏¬ª

**–¢–∞–±–ª–∏—Ü–∞ (Ant Design Table):**

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ |
|---|---|---|
| –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ | `dd.MM.yyyy HH:mm` | –ü–æ –¥–∞—Ç–µ |
| –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç | `dd.MM.yyyy HH:mm` –∏–ª–∏ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ" | –ü–æ –¥–∞—Ç–µ |
| –ù–∏–∫–Ω–µ–π–º | –ò–º—è + –∑–µ–ª—ë–Ω–∞—è —Ç–æ—á–∫–∞ –µ—Å–ª–∏ –æ–Ω–ª–∞–π–Ω | –ü–æ –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å—É |
| –ü–∞—Ä–æ–ª—å | –°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (‚Ä¢‚Ä¢‚Ä¢‚Ä¢), toggle –≤–∏–¥–∏–º–æ—Å—Ç–∏ | ‚Äî |
| –í–æ—Ä–æ–Ω–∫–∞ | 3 —á–µ–∫–±–æ–∫—Å–∞: –ù–∞—á–∞–ª —Ç–µ—Å—Ç / –ó–∞–≤–µ—Ä—à–∏–ª / –û–ø–ª–∞—Ç–∏–ª | ‚Äî |
| –í–æ–ø—Ä–æ—Å–æ–≤ –æ—Ç–≤–µ—á–µ–Ω–æ | Tag —Å —Ü–≤–µ—Ç–æ–º: `N / 45` | –ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É |
| –î–µ–π—Å—Ç–≤–∏—è | –ö–Ω–æ–ø–∫–∏ "–û—Ç–≤–µ—Ç—ã" + "–£–¥–∞–ª–∏—Ç—å" (fixed: right) | ‚Äî |

**–§–∏–ª—å—Ç—Ä:** –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–¢–æ–ª—å–∫–æ –æ–Ω–ª–∞–π–Ω" (Switch).

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å–∞:** –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–±—ã—Ç–∏–∏ `online_users_update` –æ—Ç WebSocket, —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã).

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–û—Ç–≤–µ—Ç—ã":**
- 5 –≤–∫–ª–∞–¥–æ–∫: –ü–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç / –î–æ–ø. —Ç–µ—Å—Ç—ã / –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω / –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–µ–∞–Ω—Å—É / –î–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞
- –ü–µ—Ä–≤–∏—á–Ω—ã–π —Ç–µ—Å—Ç: –Ω–æ–º–µ—Ä, —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞, –æ—Ç–≤–µ—Ç, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- –í—ã—Å–æ—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: `max-height: 60vh` —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–£–¥–∞–ª–µ–Ω–∏–µ" (–¥–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–µ):**
1. –ü–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç–∏, —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –í—Ç–æ—Ä–æ–π —ç–∫—Ä–∞–Ω: –≤–≤–æ–¥ —Ñ—Ä–∞–∑—ã "–î–∞, —è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—á—É —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)

### 6.8. –í–∫–ª–∞–¥–∫–∞ ¬´–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å¬ª (–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞)

–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ —á–µ–∫–ª–∏—Å—Ç–∞ (List –æ—Ç Ant Design). –ó–∞–¥–∞—á–∏ —Å –ø–æ–º–µ—Ç–∫–∞–º–∏:
- ‚úÖ ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚ö™ ‚Äî –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤–æ—Ä–æ–Ω–∫–∏, —Ä–µ–∞–ª-—Ç–∞–π–º, –¥–∏–∞–≥–Ω–æ–∑—ã, –¥–µ—Ç–∞–ª—å–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –ø–ª–∞—Ç–µ–∂–∏, —ç–∫—Å–ø–æ—Ä—Ç, A/B —Ç–µ—Å—Ç—ã.

### 6.9. WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

```typescript
const socket = io(apiBaseUrl, {
  transports: ['websocket', 'polling'],
  reconnection: true
});

socket.on('online_count', (count) => setActiveUsers(count));
socket.on('online_users_update', (sessionIds) => setOnlineSessionIds(sessionIds));
```

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —Ç–∞–∫–∂–µ –¥–µ–ª–∞–µ—Ç—Å—è HTTP-–∑–∞–ø—Ä–æ—Å –∫ `/api/cms/stats/active` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

### 6.10. –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–Ω–ª–∞–π–Ω

CSS-–∞–Ω–∏–º–∞—Ü–∏—è –∑–µ–ª—ë–Ω–æ–π —Ç–æ—á–∫–∏:
```css
@keyframes pulse {
  0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(82, 196, 26, 0.7); }
  70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(82, 196, 26, 0); }
  100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(82, 196, 26, 0); }
}
```

---

## 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–í—Å–µ `console.error()` –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Telegram (—Å –¥–µ–±–∞—É–Ω—Å–æ–º 1 –º–∏–Ω—É—Ç–∞ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –æ—à–∏–±–æ–∫). –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ Express + –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `unhandledRejection` –∏ `uncaughtException`.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ CMS-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤—ã–≤–æ–¥—è—Ç –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- `üìù [CMS]` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ
- `‚úÖ [CMS]` ‚Äî —É—Å–ø–µ—Ö
- `‚ùå [CMS]` ‚Äî –æ—à–∏–±–∫–∏
- `üìä [CMS]` ‚Äî –¥–∞–Ω–Ω—ã–µ/—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `üë• [CMS]` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `üóëÔ∏è [CMS]` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ

---

## 8. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

46 –≤–æ–ø—Ä–æ—Å–æ–≤ (id 1-46, –±–µ–∑ id 38). –¢–∏–ø—ã: `gender_choice`, `yes_no_scale`, `yes_no_text`, `yes_no_examples`, `scale`, `yes_no`, `budget`, `no_text`, `open_text`.

–ü–æ–ª–Ω—ã–π –º–∞—Å—Å–∏–≤ –≤—Å—Ç—Ä–æ–µ–Ω –≤ `server/routes/cms.js` (—Å—Ç—Ä–æ–∫–∏ 732-778) –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–µ `/users/:sessionId/data` –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ id ‚Üí —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞.

---

## 9. CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ origins:
```javascript
['http://localhost:3000', 'http://localhost:5000', 'https://idenself.com', 
 'https://www.idenself.com', 'http://5.129.250.81', FRONTEND_URL]
```

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—É—á–∞—é—Ç `Access-Control-Allow-Origin: *` —á–µ—Ä–µ–∑ —Ä—É—á–Ω–æ–π middleware.

---

## 10. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (npm)

–°–µ—Ä–≤–µ—Ä–Ω—ã–µ: `express`, `cors`, `dotenv`, `@supabase/supabase-js`, `socket.io`
–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ: `antd`, `recharts`, `dayjs`, `socket.io-client`, `@ant-design/icons`
